sequenceDiagram
    participant MQ as 消息队列
    participant Service as ScanService
    participant Factory as ScannerFactory
    participant Executor as ContainerExecutor
    participant Docker as Docker引擎
    participant Scanner as *_Scanner实现

    MQ->>Service: 推送任务消息
    Service->>Factory: GetScanner(scanType)
    Factory-->>Service: 返回ContainerExecutor
    Service->>Executor: AsyncExecute(task)

    Executor->>Executor: buildContainerConfig()
    Note right of Executor: 根据task.ScanType<br/>生成对应命令

    Executor->>Docker: 创建容器
    Docker->>Executor: 返回容器ID
    Executor->>Docker: 启动容器

    Docker->>Scanner: 执行容器命令
    Note left of Scanner: 如："scan sca"

    Scanner->>Docker: 返回扫描结果
    Docker->>Executor: 容器退出
    Executor->>Service: 更新任务状态
    Service->>MQ: 发布结果